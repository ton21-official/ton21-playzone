<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
  <title>T21 Play Zone</title>
  <meta name="color-scheme" content="dark light">
  <link rel="icon" href="https://raw.githubusercontent.com/ton21-official/ton21_official/main/logo.png"/>
  <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
  <style>
    :root{
      --bg:#0b0f16; --panel:#111724;
      --gold1:#ffdf88; --gold2:#f0cf6d; --txt:#e8ecf7; --muted:#9fb0c3; --ok:#25d366;
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{
      margin:0;
      background:radial-gradient(1200px 700px at 50% -10%, #1b2232 0%, var(--bg) 60%, #080b11 100%) fixed;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      color:var(--txt);display:flex;align-items:center;justify-content:center;padding:22px
    }
    .wrap{width:min(860px,100%);background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.015));
      border:1px solid rgba(255,255,255,.06);border-radius:24px;padding:22px;box-shadow:0 12px 48px rgba(0,0,0,.35)}
    .center{text-align:center}
    .logo-aura{width:140px;height:140px;margin:6px auto 0;border-radius:50%;background:radial-gradient(circle at 50% 50%, rgba(255,223,136,.5), rgba(255,223,136,0) 60%);display:grid;place-items:center}
    .logo{width:110px;height:110px;border-radius:50%;background:#0e1a2b url("https://raw.githubusercontent.com/ton21-official/ton21_official/main/logo.png") center/80% no-repeat;outline:3px solid rgba(255,223,136,.85);
      box-shadow:0 0 20px rgba(255,223,136,.55), inset 0 0 18px rgba(255,255,255,.05)}
    h1{margin:8px 0 6px;font-size:30px;text-shadow:0 2px 0 rgba(0,0,0,.25)}
    .subtitle{color:var(--muted);margin:0 0 14px;font-size:15px}
    
    /* ——— 9 плиток, компактнее ——— */
    .grid9{
      display:grid;
      gap:10px;
      grid-template-columns:repeat(3,1fr);
      max-width:330px;
      margin:16px auto;
    }
    .num{
      border:0;
      border-radius:12px;
      padding:14px 0;
      font-size:18px;
      font-weight:800;
      background:linear-gradient(180deg,var(--gold1),var(--gold2));
      color:#3a2a00;
      box-shadow:0 6px 14px rgba(240,207,109,.25), inset 0 1px 0 rgba(255,255,255,.5);
      cursor:pointer;
      transition:transform .06s;
    }
    .num:active{transform:translateY(1px) scale(.98)}

    .panel{background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.06);border-radius:16px;padding:14px;margin:10px auto;max-width:720px}
    .row{display:flex;gap:10px;flex-wrap:wrap;justify-content:center}
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:10px;border:0;border-radius:14px;padding:12px 14px;
      background:linear-gradient(180deg,var(--gold1),var(--gold2));color:#3a2a00;font-weight:800;
      box-shadow:0 10px 20px rgba(240,207,109,.25), inset 0 1px 0 rgba(255,255,255,.5);cursor:pointer}
    .btn.secondary{background:linear-gradient(180deg,#ffd86a,#f2c551)}
    .muted{color:var(--muted)} .danger{color:#ff6b6b}
    .footer{color:var(--muted);text-align:center;margin-top:8px;font-size:13px}
    .pill{border-radius:12px;border:1px solid rgba(255,255,255,.08);padding:8px 12px;background:rgba(255,255,255,.03);cursor:pointer}
    .pill.active{outline:2px solid rgba(255,223,136,.75);background:rgba(255,223,136,.08)}
    .timer{margin-top:8px} .progress{width:100%;height:10px;background:rgba(255,255,255,.1);border-radius:10px;margin-top:6px;overflow:hidden}
    .bar{height:100%;background:linear-gradient(90deg,var(--gold1),var(--gold2));transition:width 1s linear}
    input{width:90%;max-width:400px;margin-top:10px;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,.15);
      background:rgba(255,255,255,.05);color:var(--txt);text-align:center}
  </style>
</head>
<body>
<main class="wrap">
  <div class="center">
    <div class="logo-aura"><div class="logo"></div></div>
    <h1 id="t_title">T21 Play Zone</h1>
    <p id="t_sub" class="subtitle">Guess a number 1–9 & win Ton21!</p>
  </div>

  <section class="grid9" id="grid"></section>
  <div class="panel center" id="resultBox" style="display:none"></div>

  <div class="panel" id="statsPanel">
    💰 <span id="t_balance">Balance</span>: <b><span id="balance">0</span> T21</b><br>
    🎮 <span id="t_plays">Plays left today</span>: <span id="playsLeft">100</span> / 100<br>
    🔒 <span id="t_cap">Daily win cap</span>: +<span id="capUsed">0</span> / 1000 T21
  </div>

  <div class="panel center">
    <input id="userAddress" placeholder="Enter your TON address" /><br>
    <button class="btn" id="saveAddr">💾 Save Address</button>
  </div>

  <div class="panel center">
    <div class="row">
      <button class="btn" id="btnPayout"><span id="t_btnPayout">💸 Request Payout</span></button>
      <button class="btn secondary" id="btnPortal"><span id="t_btnPortal">🏠 Ton21 Portal</span></button>
    </div>
    <p class="muted" id="t_demoLine" style="margin-top:8px">💎 Demo mode. Connect wallet for real payouts.</p>
  </div>

  <div class="row" style="margin-top:8px">
    <span class="muted" id="t_lang">Language:</span>
    <span class="pill" data-lang="ru">RU</span>
    <span class="pill" data-lang="en">GB</span>
    <span class="pill" data-lang="zh">CN</span>
    <span class="pill" data-lang="hi">IN</span>
  </div>

  <p class="footer">© 2025 Ton21 Project — All rights reserved</p>
</main>

<script>
const DAILY_PLAYS=100,DAILY_CAP=1000,KEY="t21_playzone_v9";
const I18N={
 ru:{title:"T21 Play Zone",sub:"Угадай число от 1 до 9 и выиграй Ton21!",balance:"Твой баланс",
     plays:"Игр осталось сегодня",cap:"Лимит выигрыша за сутки",btnPayout:"💸 Запросить выплату",
     btnPortal:"🏠 Ton21 Portal",demo:"💎 Бесплатная демо-игра. Подключи кошелёк для реальных выплат.",
     lang:"Язык:",limitToday:"🎮 Лимит игр на сегодня исчерпан",nextPlay:"⏱ Следующая игра через",
     addr:"Ваш TON адрес",saveAddr:"💾 Сохранить адрес"},
 en:{title:"T21 Play Zone",sub:"Guess a number 1–9 & win Ton21!",balance:"Balance",plays:"Plays left today",
     cap:"Daily win cap",btnPayout:"💸 Request Payout",btnPortal:"🏠 Ton21 Portal",
     demo:"💎 Demo mode. Connect wallet for real payouts.",lang:"Language:",
     limitToday:"🎮 Limit reached for today",nextPlay:"⏱ Next play in",addr:"Your TON address",saveAddr:"💾 Save Address"},
 zh:{title:"T21 游戏区",sub:"猜 1–9 的数字并赢得 Ton21！",balance:"余额",plays:"今日剩余次数",cap:"每日上限",
     btnPayout:"💸 申请提现",btnPortal:"🏠 Ton21 门户",demo:"💎 演示模式。连接钱包以获得真实提现。",
     lang:"语言：",limitToday:"🎮 今日次数已用完",nextPlay:"⏱ 下次可玩还剩",addr:"您的 TON 地址",saveAddr:"💾 保存地址"},
 hi:{title:"T21 प्ले ज़ोन",sub:"1–9 में संख्या चुनें और Ton21 जीतें!",balance:"बैलेंस",plays:"आज शेष खेल",
     cap:"दैनिक सीमा",btnPayout:"💸 पेआउट का अनुरोध",btnPortal:"🏠 Ton21 पोर्टल",
     demo:"💎 डेमो मोड। असली पेआउट के लिए वॉलेट कनेक्ट करें।",lang:"भाषा:",
     limitToday:"🎮 आज का लिमिट पूरा",nextPlay:"⏱ अगला खेल:",addr:"आपका TON पता",saveAddr:"💾 पता सहेजें"}
};
let LANG=localStorage.getItem("lang")||"en";
function t(k){return I18N[LANG][k];}

function today(){const d=new Date();return`${d.getFullYear()}-${d.getMonth()+1}-${d.getDate()}`;}
let s=JSON.parse(localStorage.getItem(KEY)||"{}");if(s.day!==today())s={day:today(),balance:0,plays:DAILY_PLAYS,cap:0};
function save(){localStorage.setItem(KEY,JSON.stringify(s));ui();}
function ui(){balance.textContent=s.balance;playsLeft.textContent=s.plays;capUsed.textContent=s.cap;}

function weightedPrize(){const w={1:20,2:18,3:15,4:12,5:10,6:8,7:7,8:6,9:4};let r=Math.floor(Math.random()*100)+1,a=0;for(let p=1;p<=9;p++){a+=w[p];if(r<=a)return p;}return 1;}
function play(n){
 const out=resultBox;
 if(s.plays<=0){showCooldown(out);return;}
 const hidden=Math.floor(Math.random()*9)+1;
 if(n===hidden){let p=weightedPrize();s.balance+=p;s.cap+=p;out.innerHTML=`🎉 +${p} T21`; }
 else out.innerHTML=`🙂 Missed ${hidden}`;
 s.plays--; if(s.plays===0)s.next=Date.now()+24*60*60*1000; out.style.display="block"; save();
}

function showCooldown(out){
 out.style.display="block";
 if(!s.next){s.next=Date.now()+24*60*60*1000;save();}
 const label=t("nextPlay");
 function tick(){
   const r=s.next-Date.now();if(r<=0){reset();return;}
   const h=Math.floor(r/3600000),m=Math.floor((r%3600000)/60000),sec=Math.floor((r%60000)/1000);
   const total=86400000,per=100-r/total*100;
   out.innerHTML=`<div class='danger'>${t("limitToday")}</div><div class='timer'>🕐 ${label}: <b>${String(h).padStart(2,"0")}:${String(m).padStart(2,"0")}:${String(sec).padStart(2,"0")}</b></div><div class='progress'><div class='bar' style='width:${per}%'></div></div>`;
 }
 tick(); if(out._t)clearInterval(out._t); out._t=setInterval(tick,1000);
}
function reset(){s={day:today(),balance:s.balance,plays:DAILY_PLAYS,cap:0};delete s.next;save();resultBox.innerHTML="✅ New day!";}
function buildGrid(){const g=document.getElementById("grid");g.innerHTML="";for(let i=1;i<=9;i++){const b=document.createElement("button");b.className="num";b.textContent=i;b.onclick=()=>play(i);g.appendChild(b);}}
buildGrid();ui();

const addr=document.getElementById("userAddress");
addr.value=localStorage.getItem("tonAddr")||"";
document.getElementById("saveAddr").onclick=()=>{localStorage.setItem("tonAddr",addr.value.trim());alert("✅ "+t("addr")+" saved!");};

document.getElementById("btnPortal").onclick=()=>window.open("https://t.me/Ton21PortalBot","_blank");
document.getElementById("btnPayout").onclick=()=>alert("Demo mode");

function applyTexts(){
 document.getElementById("t_title").textContent=t("title");
 document.getElementById("t_sub").textContent=t("sub");
 document.getElementById("t_balance").textContent=t("balance");
 document.getElementById("t_plays").textContent=t("plays");
 document.getElementById("t_cap").textContent=t("cap");
 document.getElementById("t_btnPayout").textContent=t("btnPayout");
 document.getElementById("t_btnPortal").textContent=t("btnPortal");
 document.getElementById("t_demoLine").textContent=t("demo");
 document.getElementById("t_lang").textContent=t("lang");
 addr.placeholder=t("addr");
 document.getElementById("saveAddr").textContent=t("saveAddr");
 document.querySelectorAll(".pill").forEach(p=>p.classList.toggle("active",p.dataset.lang===LANG));
}
applyTexts();
document.querySelectorAll(".pill").forEach(p=>p.onclick=()=>{LANG=p.dataset.lang;localStorage.setItem("lang",LANG);applyTexts();});
</script>
</body>
</html>
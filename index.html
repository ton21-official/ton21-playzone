<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
  <title>T21 Play Zone</title>
  <meta name="color-scheme" content="dark light">
  <link rel="icon" href="https://raw.githubusercontent.com/ton21-official/ton21_official/main/logo.png"/>
  <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
  <style>
    :root{
      --bg:#0b0f16; --panel:#111724;
      --gold1:#ffdf88; --gold2:#f0cf6d; --txt:#e8ecf7; --muted:#9fb0c3; --ok:#25d366;
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;background:radial-gradient(1200px 700px at 50% -10%, #1b2232 0%, var(--bg) 60%, #080b11 100%) fixed;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;color:var(--txt);display:flex;align-items:center;justify-content:center;padding:22px}
    .wrap{width:min(860px,100%);background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.015));
      border:1px solid rgba(255,255,255,.06);border-radius:24px;padding:22px;box-shadow:0 12px 48px rgba(0,0,0,.35)}
    .center{text-align:center}
    .logo-aura{width:150px;height:150px;margin:6px auto 0;border-radius:50%;background:radial-gradient(circle at 50% 50%, rgba(255,223,136,.5), rgba(255,223,136,0) 60%);display:grid;place-items:center}
    .logo{width:118px;height:118px;border-radius:50%;background:#0e1a2b url("https://raw.githubusercontent.com/ton21-official/ton21_official/main/logo.png") center/80% no-repeat;outline:3px solid rgba(255,223,136,.85);
      box-shadow:0 0 24px rgba(255,223,136,.55), inset 0 0 20px rgba(255,255,255,.05)}
    h1{margin:8px 0 6px;font-size:34px;text-shadow:0 2px 0 rgba(0,0,0,.25)}
    .subtitle{color:var(--muted);margin:0 0 14px}
    .grid10{display:grid;gap:14px;grid-template-columns:repeat(5,1fr);max-width:650px;margin:18px auto}
    @media(max-width:520px){.grid10{grid-template-columns:repeat(3,1fr)}}
    .num{border:0;border-radius:14px;padding:18px 0;font-size:22px;font-weight:800;background:linear-gradient(180deg,var(--gold1),var(--gold2));color:#3a2a00;
      box-shadow:0 12px 24px rgba(240,207,109,.25), inset 0 1px 0 rgba(255,255,255,.5);cursor:pointer;transition:transform .06s}
    .num:active{transform:translateY(1px) scale(.99)}
    .panel{background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.06);border-radius:16px;padding:14px;margin:10px auto;max-width:720px}
    .row{display:flex;gap:10px;flex-wrap:wrap;justify-content:center}
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:10px;border:0;border-radius:14px;padding:14px 16px;
      background:linear-gradient(180deg,var(--gold1),var(--gold2));color:#3a2a00;font-weight:800;
      box-shadow:0 12px 24px rgba(240,207,109,.25), inset 0 1px 0 rgba(255,255,255,.5);cursor:pointer}
    .btn.secondary{background:linear-gradient(180deg,#ffd86a,#f2c551)}
    .muted{color:var(--muted)} .danger{color:#ff6b6b}
    .footer{color:var(--muted);text-align:center;margin-top:8px;font-size:13px}
    .pill{border-radius:12px;border:1px solid rgba(255,255,255,.08);padding:8px 12px;background:rgba(255,255,255,.03);cursor:pointer}
    .pill.active{outline:2px solid rgba(255,223,136,.75);background:rgba(255,223,136,.08)}
    .timer{margin-top:8px} .progress{width:100%;height:10px;background:rgba(255,255,255,.1);border-radius:10px;margin-top:6px;overflow:hidden}
    .bar{height:100%;background:linear-gradient(90deg,var(--gold1),var(--gold2));transition:width 1s linear}
  </style>
</head>
<body>
<main class="wrap">
  <div class="center">
    <div class="logo-aura"><div class="logo"></div></div>
    <h1 id="t_title">T21 Play Zone</h1>
    <p id="t_sub" class="subtitle">Guess a number 1‚Äì10 & win Ton21!</p>
  </div>

  <div class="panel center">
    <div id="ton-connect"></div>
    <div id="wallet-line" class="muted" style="margin-top:8px;"></div>
  </div>

  <section class="grid10" id="grid"></section>

  <div class="panel center" id="resultBox" style="display:none"></div>

  <div class="panel" id="statsPanel">
    üí∞ <span id="t_balance">Balance</span>: <b><span id="balance">0</span> T21</b><br>
    üéÆ <span id="t_plays">Plays left today</span>: <span id="playsLeft">100</span> / 100<br>
    üîí <span id="t_cap">Daily win cap</span>: +<span id="capUsed">0</span> / 1000 T21
  </div>

  <div class="panel center">
    <div class="row">
      <button class="btn" id="btnPayout"><span id="t_btnPayout">üí∏ Request Payout</span></button>
      <button class="btn secondary" id="btnPortal"><span id="t_btnPortal">üè† Ton21 Portal</span></button>
    </div>
    <p class="muted" id="t_demoLine" style="margin-top:8px">üíé Demo mode. Connect wallet for real payouts.</p>
  </div>

  <div class="row" style="margin-top:8px">
    <span class="muted" id="t_lang">Language:</span>
    <span class="pill" data-lang="ru">RU</span>
    <span class="pill" data-lang="en">GB</span>
    <span class="pill" data-lang="zh">CN</span>
    <span class="pill" data-lang="hi">IN</span>
  </div>

  <p class="footer">¬© 2025 Ton21 Project ‚Äî All rights reserved</p>
</main>

<script>
  // ---------- Config ----------
  const DAILY_PLAYS=100, DAILY_CAP=1000;
  const BACKEND_URL="https://YOUR-BACKEND.example/payout";
  const KEY="t21_playzone_v6";

  // ---------- i18n ----------
  const I18N = {
    ru: {
      title:"T21 Play Zone",
      sub:"–£–≥–∞–¥–∞–π —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 10 –∏ –≤—ã–∏–≥—Ä–∞–π Ton21!",
      balance:"–¢–≤–æ–π –±–∞–ª–∞–Ω—Å",
      plays:"–ò–≥—Ä –æ—Å—Ç–∞–ª–æ—Å—å —Å–µ–≥–æ–¥–Ω—è",
      cap:"–õ–∏–º–∏—Ç –≤—ã–∏–≥—Ä—ã—à–∞ –∑–∞ —Å—É—Ç–∫–∏",
      btnPayout:"üí∏ –ó–∞–ø—Ä–æ—Å–∏—Ç—å –≤—ã–ø–ª–∞—Ç—É",
      btnPortal:"üè† Ton21 Portal",
      demo:"üíé –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –¥–µ–º–æ-–∏–≥—Ä–∞. –ü–æ–¥–∫–ª—é—á–∏ –∫–æ—à–µ–ª—ë–∫ –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –≤—ã–ø–ª–∞—Ç.",
      lang:"–Ø–∑—ã–∫:",
      limitToday:"üéÆ –õ–∏–º–∏—Ç –∏–≥—Ä –Ω–∞ —Å–µ–≥–æ–¥–Ω—è –∏—Å—á–µ—Ä–ø–∞–Ω",
      capToday:"üîí –î–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –≤—ã–∏–≥—Ä—ã—à–∞ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è",
      nextPlay:"‚è± –°–ª–µ–¥—É—é—â–∞—è –∏–≥—Ä–∞ —á–µ—Ä–µ–∑"
    },
    en: {
      title:"T21 Play Zone",
      sub:"Guess a number 1‚Äì10 & win Ton21!",
      balance:"Balance",
      plays:"Plays left today",
      cap:"Daily win cap",
      btnPayout:"üí∏ Request Payout",
      btnPortal:"üè† Ton21 Portal",
      demo:"üíé Demo mode. Connect wallet for real payouts.",
      lang:"Language:",
      limitToday:"üéÆ Limit reached for today",
      capToday:"üîí Cap reached for today",
      nextPlay:"‚è± Next play in"
    },
    zh: {
      title:"T21 Ê∏∏ÊàèÂå∫",
      sub:"Áåú 1‚Äì10 ÁöÑÊï∞Â≠óÂπ∂Ëµ¢Âæó Ton21ÔºÅ",
      balance:"‰ΩôÈ¢ù",
      plays:"‰ªäÊó•Ââ©‰ΩôÊ¨°Êï∞",
      cap:"ÊØèÊó•‰∏äÈôê",
      btnPayout:"üí∏ Áî≥ËØ∑ÊèêÁé∞",
      btnPortal:"üè† Ton21 Èó®Êà∑",
      demo:"üíé ÊºîÁ§∫Ê®°Âºè„ÄÇËøûÊé•Èí±ÂåÖ‰ª•Ëé∑ÂæóÁúüÂÆûÊèêÁé∞„ÄÇ",
      lang:"ËØ≠Ë®ÄÔºö",
      limitToday:"üéÆ ‰ªäÊó•Ê¨°Êï∞Â∑≤Áî®ÂÆå",
      capToday:"üîí ‰ªäÊó•‰∏äÈôêÂ∑≤Ëææ",
      nextPlay:"‚è± ‰∏ãÊ¨°ÂèØÁé©ËøòÂâ©"
    },
    hi: {
      title:"T21 ‡§™‡•ç‡§≤‡•á ‡§ú‡§º‡•ã‡§®",
      sub:"1‚Äì10 ‡§Æ‡•á‡§Ç ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç ‡§î‡§∞ Ton21 ‡§ú‡•Ä‡§§‡•á‡§Ç!",
      balance:"‡§¨‡•à‡§≤‡•á‡§Ç‡§∏",
      plays:"‡§Ü‡§ú ‡§∂‡•á‡§∑ ‡§ñ‡•á‡§≤",
      cap:"‡§¶‡•à‡§®‡§ø‡§ï ‡§∏‡•Ä‡§Æ‡§æ",
      btnPayout:"üí∏ ‡§™‡•á‡§Ü‡§â‡§ü ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß",
      btnPortal:"üè† Ton21 ‡§™‡•ã‡§∞‡•ç‡§ü‡§≤",
      demo:"üíé ‡§°‡•á‡§Æ‡•ã ‡§Æ‡•ã‡§°‡•§ ‡§Ö‡§∏‡§≤‡•Ä ‡§™‡•á‡§Ü‡§â‡§ü ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡•â‡§≤‡•á‡§ü ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§",
      lang:"‡§≠‡§æ‡§∑‡§æ:",
      limitToday:"üéÆ ‡§Ü‡§ú ‡§ï‡§æ ‡§≤‡§ø‡§Æ‡§ø‡§ü ‡§™‡•Ç‡§∞‡§æ",
      capToday:"üîí ‡§Ü‡§ú ‡§ï‡•Ä ‡§∏‡•Ä‡§Æ‡§æ ‡§™‡•Ç‡§∞‡•Ä",
      nextPlay:"‚è± ‡§Ö‡§ó‡§≤‡§æ ‡§ñ‡•á‡§≤:"
    }
  };

  function getLang(){
    const saved = localStorage.getItem("t21_lang");
    if(saved && I18N[saved]) return saved;
    const sys = (navigator.language||"en").slice(0,2).toLowerCase();
    return I18N[sys] ? sys : "en";
  }
  let LANG = getLang();

  function applyTexts(){
    const t = I18N[LANG];
    // –∑–∞–≥–æ–ª–æ–≤–æ–∫ + –ø–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫
    document.getElementById("t_title").textContent = t.title;
    document.getElementById("t_sub").textContent = t.sub;

    // —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    document.getElementById("t_balance").textContent = t.balance;
    document.getElementById("t_plays").textContent = t.plays;
    document.getElementById("t_cap").textContent = t.cap;

    // –∫–Ω–æ–ø–∫–∏ –∏ –ø–æ–¥–ø–∏—Å–∏
    document.getElementById("t_btnPayout").textContent = t.btnPayout;
    document.getElementById("t_btnPortal").textContent = t.btnPortal;
    document.getElementById("t_demoLine").textContent = t.demo;
    document.getElementById("t_lang").textContent = t.lang;

    // –∞–∫—Ç–∏–≤–Ω–∞—è –ø–∏–ª—é–ª—è
    document.querySelectorAll(".pill").forEach(p=>{
      p.classList.toggle("active", p.dataset.lang===LANG);
    });

    // –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç –±–∞–Ω–Ω–µ—Ä —Å –ª–∏–º–∏—Ç–æ–º ‚Äî –ø–µ—Ä–µ—Ä–∏—Å—É–µ–º –µ–≥–æ —Ç–æ–∂–µ
    if(document.getElementById("resultBox").dataset.mode==="limit") {
      showCooldown(document.getElementById("resultBox"), I18N[LANG].limitToday);
    }
    if(document.getElementById("resultBox").dataset.mode==="cap") {
      showCooldown(document.getElementById("resultBox"), I18N[LANG].capToday);
    }
  }
  function setLang(code){
    if(!I18N[code]) return;
    LANG = code;
    localStorage.setItem("t21_lang", code);
    applyTexts();
  }

  // ---------- State ----------
  function todayKey(){const d=new Date();return`${d.getFullYear()}-${d.getMonth()+1}-${d.getDate()}`;}
  function loadState(){const s=JSON.parse(localStorage.getItem(KEY)||"{}");const day=todayKey();return s.day===day?s:{day,balance:0,plays:DAILY_PLAYS,cap:0};}
  let state=loadState();
  function save(){localStorage.setItem(KEY,JSON.stringify(state));ui();}

  // ---------- Game ----------
  function weightedPrize(){const w={1:18,2:16,3:14,4:12,5:10,6:8,7:7,8:6,9:5,10:4};
    let r=Math.floor(Math.random()*100)+1,a=0;for(let p=1;p<=10;p++){a+=w[p];if(r<=a)return p;}return 1;}

  function play(n){
    const out=document.getElementById("resultBox");
    if(state.plays<=0){showCooldown(out, I18N[LANG].limitToday, "limit");return;}
    if(state.cap>=DAILY_CAP){showCooldown(out, I18N[LANG].capToday, "cap");return;}

    const hidden=Math.floor(Math.random()*10)+1;
    if(n===hidden){
      let p=weightedPrize(); if(state.cap+p>DAILY_CAP) p=Math.max(0,DAILY_CAP-state.cap);
      state.balance+=p; state.cap+=p;
      out.dataset.mode=""; out.style.display="block";
      out.innerHTML=`üéâ ${I18N[LANG].sub.split(' ')[0]} ${hidden}! +${p} T21`;
    }else{
      out.dataset.mode=""; out.style.display="block";
      out.innerHTML=`üôÇ Missed. Was <b>${hidden}</b>`;
    }
    state.plays--; if(state.plays===0){state.nextReset=Date.now()+24*60*60*1000;}
    save();
  }

  function showCooldown(out,msg,mode="limit"){
    out.dataset.mode=mode;
    out.style.display="block";
    if(!state.nextReset){state.nextReset=Date.now()+24*60*60*1000;save();}
    const tLabel=I18N[LANG].nextPlay;

    function tick(){
      const remain=state.nextReset-Date.now();
      if(remain<=0){resetDay(); return;}
      const h=Math.floor(remain/3600000);
      const m=Math.floor((remain%3600000)/60000);
      const s=Math.floor((remain%60000)/1000);
      const total=24*3600000;
      const percent=Math.max(0,100-remain/total*100);
      out.innerHTML=`<div class="danger">${msg}</div>
        <div class="timer">üïê ${tLabel}: <b>${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}</b></div>
        <div class="progress"><div class="bar" style="width:${percent}%"></div></div>`;
    }
    tick();
    if(out._timer) clearInterval(out._timer);
    out._timer=setInterval(tick,1000);
  }

  function resetDay(){
    const out=document.getElementById("resultBox");
    if(out._timer) clearInterval(out._timer);
    state={day:todayKey(),balance:state.balance,plays:DAILY_PLAYS,cap:0};
    delete state.nextReset; save();
    out.dataset.mode=""; out.innerHTML="‚úÖ New day! You can play again.";
  }

  function ui(){
    document.getElementById("balance").textContent=state.balance;
    document.getElementById("playsLeft").textContent=state.plays;
    document.getElementById("capUsed").textContent=state.cap;
  }

  // ---------- UI build ----------
  function buildGrid(){
    const g=document.getElementById("grid"); g.innerHTML="";
    for(let i=1;i<=10;i++){const b=document.createElement("button");
      b.className="num"; b.textContent=i; b.onclick=()=>play(i); g.appendChild(b);}
  }

  // ---------- Links / Wallet ----------
  document.getElementById("btnPortal").onclick=()=>window.open("https://t.me/Ton21PortalBot","_blank");
  document.getElementById("btnPayout").onclick=()=>alert("Demo mode");

  // ---------- Init ----------
  (function init(){
    try{ window.Telegram?.WebApp?.expand(); }catch(e){}
    buildGrid(); ui();
    document.querySelectorAll(".pill").forEach(p=>p.addEventListener("click",()=>setLang(p.dataset.lang)));
    applyTexts(); // –≤–∞–∂–Ω–æ–µ: —Å—Ä–∞–∑—É –ø—Ä–∏–º–µ–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —è–∑—ã–∫
  })();
</script>
</body>
</html>